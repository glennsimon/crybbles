<html>
  <head>
    <script>
      let bigNum = '0x';
      let tokenData;

      for (let i = 0; i < 8; i++) {
        let num = Math.round(Math.random() * parseInt('FFFFFFFF', 16)).toString(
          16
        );
        while (num.length < 8) {
          num = '0' + num;
        }
        bigNum += num;
      }

      tokenData = { hash: bigNum, tokenId: '1234567' };
    </script>
  </head>
  <body>
    <div id="container">
      <div id="floor-datum">
        <div id="floor"></div>
      </div>
    </div>
    <script>
const t=t=>2*Math.PI*t/360,n=t=>360*t/(2*Math.PI),e=Math.min(window.innerWidth,window.innerHeight)-20,a=e,r=5*e/3,o=r,s=r/3,i=[5,9],l=[-e,e],d=[e/6,e/3],$=[6,15],c=[3,10];let p=0,b="incr";const m={},f={},h=[],g=[],u=[],x=document.createElement("style");document.head.appendChild(x);const M=t=>{const n=document.getElementById("floor"),e=document.createElement("div");e.classList.add("b"+t+"-tran-datum","bubble-tran-datum");const a=document.createElement("div");a.classList.add("b"+t+"-grow-datum");const r=document.createElement("div");switch(r.classList.add("b"+t+"-element"),a.append(r),e.append(a),n.append(e),h[t].bubbleType){case"cube":for(let n=1;n<7;n++){const e=document.createElement("div");e.classList.add("b"+t+"-cube-face","b"+t+"-cube-face"+n),r.append(e)}break;case"tetra":for(let n=1;n<5;n++){const e=document.createElement("div");e.classList.add("b"+t+"-tet-face","b"+t+"-tet-face"+n),r.append(e)}break;case"dodec":for(let n=1;n<13;n++){const e=document.createElement("div");e.classList.add("b"+t+"-dod-face","b"+t+"-dod-face"+n.toString(16).toUpperCase()),r.append(e)}}e.addEventListener("animationend",(()=>e.remove()))},Z="-tran-datum",w="-grow-datum",v="-element",B="-cube-face",C="-tet-face",T="-dod-face",E="background: radial-gradient(circle at center, transparent 0, ",k=(e,r,o,s,i,l,d)=>{let $,c,p,b,m,f;switch(h[e].bubbleType){case"cube":c=Math.sqrt(3*(r/2)**2),p=r/2,x.innerHTML+=`\n.b${e+B} {\nwidth: ${r}px;\nheight: ${r}px;\nleft: ${c-p};\ntop: ${c-p};\n}\n.b${e+B}1 {\n${E+q(R(),127)}70 100%);\ntransform: translateZ(${p}px);\n}\n.b${e+B}2 {\n${E+q(R(),127)}70 100%);\ntransform: rotateY(180deg) translateZ(${p}px);\n}\n.b${e+B}3 {\n${E+q(R(),127)}70 100%);\ntransform: rotateY(90deg) translateZ(${p}px);\n}\n.b${e+B}4 {\n${E+q(R(),127)}70 100%);\ntransform: rotateY(-90deg) translateZ(${p}px);\n}\n.b${e+B}5 {\n${E+q(R(),127)}70 100%);\ntransform: rotateX(90deg) translateZ(${p}px);\n}\n.b${e+B}6 {\n${E+q(R(),127)}70 100%);\ntransform: rotateX(-90deg) translateZ(${p}px);\n}`;break;case"tetra":$=1.6*r,b=$/Math.sqrt(3),m=b/2,f=Math.asin(m/(m+b));let a=Math.PI/2-f,o=b/Math.cos(f);p=(b+m)*Math.cos(f)-o,c=Math.sqrt(p**2+b**2),x.innerHTML+=`\n.b${e+C} {\nwidth: 100%;\nheight: 100%;\nposition: absolute;\nclip-path: polygon(50% ${c+b}px,\n${c-$/2}px ${c-m}px,\n${c+$/2}px ${c-m}px);\ntransform-origin: 50% 50%;\n}\n.b${e+C}1 {\n${E+q(R(),127)}70 70%);\ntransform: translateZ(-${p}px);\n}\n.b${e+C}2 {\n${E+q(R(),127)}70 70%);\ntransform: rotateX(${n(a)}deg) translateZ(${p}px);\n}\n.b${e+C}3 {\n${E+q(R(),127)}70 70%);\ntransform: rotate3d(-0.5, ${Math.sqrt(3)/2}, 0, ${n(a)}deg) translateZ(${p}px);\n}\n.b${e+C}4 {\n${E+q(R(),127)}70 70%);\ntransform: rotate3d(0.5, ${Math.sqrt(3)/2}, 0, -${n(a)}deg) translateZ(${p}px);\n}`;break;case"dodec":m=.42*r;let s=54,i=72,l=m*Math.cos(t(i/2)),d=2*m*Math.sin(t(i/2)),h=2*m*Math.sin(t(i)),g=d*Math.sin(t(180-2*s));b=(h-d)/2/Math.cos(t(s));let u=b*Math.sin(t(s));f=Math.PI/2-Math.asin(u/g);let y=n(f);p=l/Math.tan(f/2),c=Math.sqrt(m**2+p**2),x.innerHTML+=`\n.b${e+T} {\nwidth: 100%;\nheight: 100%;\nclip-path: polygon(${c}px ${c-m}px,\n${c+h/2}px ${c-(g-l)}px,\n${c+d/2}px ${c+l}px,\n${c-d/2}px ${c+l}px,\n${c-h/2}px ${c-(g-l)}px);\ntransform-origin: 50% 50%;\n}\n.b${e+T}1 {\n${E+q(R(),127)}80 70%);\ntransform: translateZ(${p}px);\n}\n.b${e+T}2 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(1, 0, 0, -${y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}3 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(${Math.cos(t(72))}, ${Math.sin(t(72))}, 0, -${y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}4 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(-${Math.cos(t(36))}, ${Math.sin(t(36))}, 0, -${y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}5 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(-${Math.cos(t(36))}, -${Math.sin(t(36))}, 0, -${y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}6 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(${Math.cos(t(72))}, -${Math.sin(t(72))}, 0, -${y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}7 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(1, 0, 0, -${180+y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}8 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(${Math.cos(t(72))}, ${Math.sin(t(72))}, 0, -${180+y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}9 {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(-${Math.cos(t(36))}, ${Math.sin(t(36))}, 0, -${180+y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}A {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(-${Math.cos(t(36))}, -${Math.sin(t(36))}, 0, -${180+y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}B {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(${Math.cos(t(72))}, -${Math.sin(t(72))}, 0, -${180+y}deg) rotateZ(36deg) translateZ(${p}px);\n}\n.b${e+T}C {\n${E+q(R(),127)}80 70%);\ntransform: rotate3d(1, 0, 0, 180deg) translateZ(${p}px);\n}`}x.innerHTML+=`\n.b${e+Z} {\nwidth: ${2*c}px;\nheight: ${2*c}px;\nleft: ${h[e].location[0]-c}px;\ntop: ${h[e].location[1]-c}px;\ntransform-style: preserve-3d;\nanimation: b${e}-translate ${s}s ease-in forwards;\n}\n.b${e+w} {\nwidth: ${2*c}px;\nheight: ${2*c}px;\ntransform-style: preserve-3d;\nanimation: b${e}-size ${s}s linear forwards;\n}\n.b${e+v} {\nwidth: ${2*c}px;\nheight: ${2*c}px;\ntransform-style: preserve-3d;\nanimation: b${e}-spin ${l}s linear infinite;\n}`,x.innerHTML+=`\n@keyframes b${e}-spin { \nfrom { transform: rotate3d(${i[0]}, ${i[1]}, ${i[2]}, 0deg); }\nto { transform: rotate3d(${i[0]}, ${i[1]}, ${i[2]}, 360deg); }\n}\n@keyframes floor-rot { \nto { transform: rotateZ(360deg); }\n}\n@keyframes b${e}-translate { \nto { transform: translateZ(${2*a}px); left: ${h[e].location[0]+o}px; }\n}\n@keyframes b${e}-size { \n0% { transform: scale3d(0.1, 0.1, 0.1); }\n3.3% { transform: scale3d(0.5, 0.5, 0.5); }\n33.3% { transform: scale3d(1, 1, 1); }\n}`},L=(t,n)=>{const e=m.fracArray[I()];return Math.floor((1-e)*t+e*(n+1))},H=(t,n)=>{const e=m.fracArray[I()]+.5/256;return(1-e)*t+e*n},I=()=>(p===m.fracArray.length-1?b="decr":0===p&&(b="incr"),"incr"===b?p++:p--),P=()=>{f.numberOfBubbles=L(i[0],i[1]),f.floorRotPeriod=15*L(0,3),f.bubbleTypes=L(1,3),f.bgBaseColor=q(R(),-100)},A=t=>{const n=[],e=[],a=t.slice(2);for(let t=0;t<63;t++){const r=a.slice(t,t+2);n[t]=r,e[t]=parseInt(r,16)/256}m.hexArray=n,m.fracArray=e},R=()=>{let t="#";for(let n=0;n<3;n++)t+=m.hexArray[I()];return t},q=(t,n)=>{t=t.slice(1);let e="#";for(;t.length>1;){let a=parseInt(t.substring(0,2),16)+n;a=a>255?255:a<0?0:a,tempColorHex=a.toString(16),e+=2===tempColorHex.length?tempColorHex:"0"+tempColorHex,t=t.slice(2)}return e},N=()=>{const n=f.numberOfBubbles,e=r/2,a=o/2,i=H(t(-45),t(45)),l=t(360/n);let d=[];for(let t=0;t<n;t++){const n=L(s/4,s),r=i+t*l;d.push([e+n*Math.sin(r),a+n*Math.cos(r)])}let $=["cube","tetra","dodec"];3!==f.bubbleTypes&&$.splice(L(-1,1),1),1===f.bubbleTypes&&$.splice(L(0,1),1);for(let t=0;t<n;t++)h[t]={},h[t].bubbleType=$[t%$.length],h[t].location=d[t]};async function z(){const t=f.numberOfBubbles,n=H(l[0],l[1]);setTimeout(Y,1e4);for(let e=0;e<t;e++){const t=L(d[0],d[1]),r=L($[0],$[1]),o=[m.fracArray[I()],m.fracArray[I()],m.fracArray[I()]],s=H(c[0],c[1]);k(e,t,n,r,o,s);const i=r*L(2*t,3*t)*1e3/(2*a/3*1.72);M(e),g[e]=setInterval(M,i,e),await new Promise((t=>setTimeout(t,1500*m.fracArray[I()])))}}const O=()=>{const t=document.getElementsByClassName("bubble-tran-datum"),n=document.getElementById("container").getBoundingClientRect();for(let e=0;e<t.length;e++){t[e].className.split(" ")[0];if(!u.includes(t[e])){const a=t[e].children[0].children[0].children;for(let r=0;r<a.length;r++){const o=a[r].getBoundingClientRect(),s=a[r].clientHeight;if(o.top+Math.min(o.height,s)>n.top&&o.top<n.bottom){u.push(t[e]);break}}}}},S=()=>{clearInterval(X);const t=[...document.getElementsByClassName("bubble-tran-datum")];for(bubble of t)u.includes(bubble)||bubble.remove()};let X;const Y=()=>{const t=L(1,5)<5;for(let n=0;n<f.numberOfBubbles;n++){clearInterval(g[n]);let e=document.body.getElementsByClassName("b"+n+"-tran-datum");document.getElementById("container");for(const t of e)t.style.animationPlayState="paused";e=document.body.getElementsByClassName("b"+n+"-grow-datum");for(const t of e)t.style.animationPlayState="paused";if(t){e=document.body.getElementsByClassName("b"+n+"-element");for(const t of e)t.style.animationPlayState="paused"}}X=setInterval(O,1e3),setTimeout(S,1e3*(f.floorRotPeriod+1))},D=t=>{var n,s;A(t),f.numberOfBubbles=L(i[0],i[1]),f.floorRotPeriod=15*L(0,3),f.bubbleTypes=L(1,3),f.bgBaseColor=q(R(),-100),n=f.bgBaseColor,s=50,x.innerHTML=`\n* {box-sizing: border-box;position: absolute;}\nbody {margin: 0;padding: 0;}\n#container {\nposition: fixed;\nwidth: ${e}px;\nheight: ${a}px;\ntop: 50%;\nleft: 50%;\nmargin-top: -${e/2}px;\nmargin-left: -${e/2}px;\noverflow: hidden;\nperspective: ${.9*e}px;\nbackground: radial-gradient(circle at bottom,\n${q(n,s)},\n${n});\n}\n#floor-datum {\nwidth: ${r}px;\nheight: ${o}px;\nleft: -${e/3}px;\ntransform-style: preserve-3d;\ntransform: rotateX(90deg);\n}\n#floor {\nwidth: ${r}px;\nheight: ${o}px;\nbackground: radial-gradient(circle at center,\n${q(n,s)}B0,\n${n}B0 70.7%, transparent 70.7%);\ntransform-style: preserve-3d;\nanimation: floor-rot ${f.floorRotPeriod}s linear infinite;\n}`,N(),z()};D(tokenData.hash),window.onresize=()=>location.reload();
    </script>
  </body>
</html>
